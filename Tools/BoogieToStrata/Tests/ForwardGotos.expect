program Core;
type StrataHeap;
type StrataRef;
type StrataField (t: Type);

// Uninterpreted procedures
// Implementations
procedure SimpleForwardGoto() returns ()

{
  var x : int;
  _exit: {
    L2: {
      L0: {
        x := 1;
        exit L2;
      }

      L1: {
        x := 2;
        exit L2;
      }
    }

    L2: {
      assert (x >= 1);
      exit _exit;
    }
  }
};

procedure DiamondGoto(b : bool) returns ()

{
  var x : int;
  _exit: {
    join: {
      left: {
        entry: {
          x := 0;
          exit left;
        }
      }

      left: {
        x := (x + 1);
        exit join;
      }

      right: {
        x := (x + 2);
        exit join;
      }
    }

    join: {
      assert (x >= 1);
      exit _exit;
    }
  }
};

procedure ChainedForwardGotos() returns ()

{
  var x : int;
  _exit: {
    D: {
      C: {
        B: {
          A: {
            x := 0;
            exit B;
          }
        }

        B: {
          x := (x + 1);
          exit C;
        }
      }

      C: {
        x := (x + 1);
        exit D;
      }
    }

    D: {
      assert (x == 2);
      exit _exit;
    }
  }
};

procedure SkipBlocks() returns ()

{
  var x : int;
  _exit: {
    done: {
      start: {
        x := 10;
        exit done;
      }

      middle: {
        x := -(1);
        exit done;
      }
    }

    done: {
      assert (x == 10);
      exit _exit;
    }
  }
};

